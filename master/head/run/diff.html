<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><!--Generated by the DeltaXML.com xhtml-outfilter.xsl--><!--Using XSL Processor: Saxonica--><title>XProc -[[3.0]]- +[[3.1]]+: dynamic pipeline execution</title><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" /><link class="removeOnSave" crossorigin="anonymous" href="https://www.w3.org" rel="preconnect" /><link as="script" class="removeOnSave" href="js/fixup.js" rel="preload" /><link as="style" class="removeOnSave" href="css/base.css" rel="preload" /><link as="image" class="removeOnSave" href="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" rel="preload" /><link rel="stylesheet" href="css/cg-draft.css" /><link rel="stylesheet" href="css/respec.css" /><link rel="alternate" title="XML" href="specification.xml" /><meta name="generator" content="DocBook XSL 2.0 Stylesheets V2.5.0" /><meta name="description" content="Abstract This specification describes the p:run&#xA;step for&#xA;XProc 3.1: An XML Pipeline Language." /><link href="css/default.css" rel="stylesheet" type="text/css" /><link href="css/db-prism.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="css/base.css" /><link rel="stylesheet" type="text/css" href="css/xproc.css" /><link rel="stylesheet" type="text/css" href="css/print.css" media="print" /><script type="text/javascript" src="js/dbmodnizr.js"></script><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><link rel="stylesheet" href="/css/autodiff.css" /></head><body class="h-entry informative toc-sidebar"><div style="position:fixed; clear:both; top:0px" id="_autodiff_buttons"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a><a class="button" onclick="view('only')">
              View Only
            </a><a class="button" onclick="scroll_to('prev')">
              Previous
            </a><a class="button" onclick="scroll_to('next')">
              Next
            </a><span id="__autodiff__"></span></p></div><div class="head" id="spec.head"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72" /></a><h1 class="title p-name" id="title">XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span>: dynamic pipeline execution</h1><h2><span class="deltaxml-old" style="background:#FF5555">Draft </span>Community Group Report <time class="dt-published" datetime="2024-08-20">20 August 2024</time></h2><div class="editors-draft"><span class="deltaxml-old" style="background:#FF5555">Editor's Draft at </span><time class="dt-timestamp" datetime="20240820T15:10:56Z"><span class="deltaxml-old" style="background:#FF5555">15:10 UTC</span></time><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="https://github.com/xproc//commit/577bcd228882c1af53ce0ba43c4110bca81d9cd4"><span class="deltaxml-old" style="background:#FF5555">build 49</span></a><span class="deltaxml-old" style="background:#FF5555">)</span></div><dl><dt>Latest editor’s draft:</dt><dd><a href="https://spec.xproc.org/master/head/run/">https://spec.xproc.org/master/head/run/</a></dd><dt>Editors:</dt><dd><span class="personname">Norman Walsh</span></dd><dd><span class="personname">Achim Berndzen</span></dd><dd><span class="personname">Gerrit Imsieke</span></dd><dd><span class="personname">Erik Siegel</span></dd><dt>Participate:</dt><dd><a href="http://github.com/xproc/3.0-steps">GitHub xproc/3.0-steps</a></dd><dd><a href="http://github.com/xproc/3.0-steps/issues">Report an issue</a></dd><dt>Changes:</dt><dd><a href="diff.html">Diff against current “status quo” draft</a></dd><dd><a href="http://github.com/xproc//commits/">Commits for this specification</a></dd></dl><p>This document is also available in these non-normative formats: <a href="specification.xml">XML</a> and HTML with automatic change markup courtesy of <a href="http://www.deltaxml.com/">DeltaXML</a>.</p><p class="copyright"><span style="display: none;" class="delete_version"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © <span class="years">2018, 2019, 2020, 2024</span> the Contributors to the <cite>XProc 3.0: dynamic pipeline execution</cite> specification, published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.</span><span style="display: none;" class="add_version"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © <span class="years">2018, 2019, 2020, 2024</span> the Contributors to the <cite>XProc 3.1: dynamic pipeline execution</cite> specification, published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.</span><span class="modify_version"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © <span class="years">2018, 2019, 2020, 2024</span> the Contributors to the <cite>XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span>: dynamic pipeline execution</cite> specification, published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.</span></p><hr title="Separator for header" /><section class="introductory" id="abstract"><h2>Abstract</h2><p><span style="display: none;" class="delete_version">This specification describes the <code class="code">p:run</code> step for <em class="citetitle">XProc 3.0: An XML Pipeline Language</em>.</span><span style="display: none;" class="add_version">This specification describes the <code class="code">p:run</code> step for <em class="citetitle">XProc 3.1: An XML Pipeline Language</em>.</span><span class="modify_version">This specification describes the <code class="code">p:run</code> step for <em class="citetitle">XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span>: An XML Pipeline Language</em>.</span></p></section><section class="introductory" id="sotd"><h2>Status of this Document</h2><p><strong><span class="deltaxml-old" style="background:#FF5555">This document is an editor's draft that has no official standing.</span></strong></p><p>This specification was published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a>. It is not a W3C Standard nor is it on the W3C Standards Track. Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply. Learn more about <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>. </p><p>If you wish to make comments regarding this document, please send them to <a href="mailto:xproc-dev@w3.org">xproc-dev@w3.org</a>. (<a href="mailto:xproc-dev-request@w3.org?subject=subscribe">subscribe</a>, <a href="https://lists.w3.org/Archives/Public/xproc-dev/">archives</a>). </p><div class="note editorial admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><div class="admonition-body"><p><span class="deltaxml-new" style="background:#90EE90">This draft is a “last call” draft. This version is stable and will not be updated. </span></p></div></div></section></div><div class="lists-of-titles"><nav id="toc"><h2 id="TableOfContents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#c.run"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">p:run</span></a><a class="tocxref" href="#library"><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Step library</span></a><ul class="toc"><li class="tocline"><a class="tocxref" href="#c.run"><bdi class="secno">2.1. </bdi><span class="deltaxml-old" style="background:#FF5555">Example</span><span class="deltaxml-new" style="background:#90EE90">p:run</span></a><ul class="toc"><li class="tocline"><a class="tocxref" href="#example-run"><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Example</span></a></li><li class="tocline"><a class="tocxref" href="#c.run.19"><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.2. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Document properties</span></a></li></ul></li><li class="delete_version" style="display: none;"><a class="tocxref" href="#c.run.19"><bdi class="secno">2.2. </bdi>Document properties</a></li><li class="tocline"><a class="tocxref" href="#c.run.19"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Document properties</span></a></li></ul></li><li class="tocline"><a class="tocxref" href="#errors"><bdi class="secno">3. </bdi>Step Errors</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">A. </bdi>Conformance</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#implementation-defined"><bdi class="secno">A.1. </bdi>Implementation-defined features</a></li></ul></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>References</a></li><li class="tocline"><a class="tocxref" href="#glossary"><bdi class="secno">C. </bdi>Glossary</a></li><li class="tocline"><a class="tocxref" href="#ancillary-files"><bdi class="secno">D. </bdi>Ancillary files</a></li></ol></nav></div><article class="specification"><section class="section" id="introduction"><div class="section-titlepage"><h2><bdi class="secno">1. </bdi>Introduction<a aria-label="§" class="self-link" href="#introduction"></a></h2></div><div class="content"><p>This specification describes the <code class="code">p:run</code> XProc step. A machine-readable description of this step may be found in <a href="steps.xpl">steps.xpl</a>. </p><p>Familarity with the general nature of [<a><span style="display: none;" class="delete_version" href="#xproc30"><span class="abbrev">XProc 3.0</span></span><span style="display: none;" class="add_version" href="#xproc31"><span class="abbrev">XProc 3.1</span></span><span class="modify_version" href="#xproc31"><span class="abbrev">XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span></span></span></a>] steps is assumed<span class="deltaxml-old" style="background:#FF5555">; for background details, see [</span><a href="#xproc30-steps"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XProc 3.0 Steps</span></span></a><span class="deltaxml-old" style="background:#FF5555">]</span>.</p></div></section><section id="c.run" class="section"><div class="section-titlepage"><h2><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">p:run</span><a aria-label="§" class="self-link" href="#c.run"></a></h2></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step runs a dynamically loaded pipeline.</span></p><p class="element-syntax element-syntax-language-construct"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:run</span><span class="deltaxml-old" style="background:#FF5555">  name? = </span><var><span class="deltaxml-old" style="background:#FF5555">NCName</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    (</span><a href="#p.with-input"><span class="deltaxml-old" style="background:#FF5555">p:with-input</span></a><span class="deltaxml-old" style="background:#FF5555">? &amp; </span><span class="deltaxml-old" style="background:#FF5555">     </span><a href="#p.run-input"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></a><span class="deltaxml-old" style="background:#FF5555">* &amp; </span><span class="deltaxml-old" style="background:#FF5555">     </span><a href="#p.run-option"><span class="deltaxml-old" style="background:#FF5555">p:run-option</span></a><span class="deltaxml-old" style="background:#FF5555">* &amp; </span><span class="deltaxml-old" style="background:#FF5555">     </span><a href="#p.output"><span class="deltaxml-old" style="background:#FF5555">p:output</span></a><span class="deltaxml-old" style="background:#FF5555">*)</span><span class="deltaxml-old" style="background:#FF5555">&lt;/p:run&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step has a single, anonymous input that accepts the pipeline to be run. Otherwise, it functions similar to an atomic step in that you can define input connections and option values for it, albeit not with the usual </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:with-input</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></code><span class="deltaxml-old" style="background:#FF5555"> connections.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step expects a single pipeline document on its anonymous input port (“pipeline port”). Independent of how the pipeline is provided, it </span><span class="rfc2119" id="c.run.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> have a </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute on its root element. </span><a id="err.inline.C0200&#34;"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0200"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0200</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the pipeline input to the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step is not a valid pipeline. The anonymous input port is not primary, although it is the only </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:input</span></code><span class="deltaxml-old" style="background:#FF5555"> port of </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555">. Therefore it will not automatically connect to the </span><em><span class="deltaxml-old" style="background:#FF5555">default readable port</span></em><span class="deltaxml-old" style="background:#FF5555"> (see </span><cite><a href="../xproc/#connections"><span class="deltaxml-old" style="background:#FF5555">Connections</span></a></cite><span class="deltaxml-old" style="background:#FF5555"> in </span><cite><a href="../xproc/"><span class="deltaxml-old" style="background:#FF5555">XProc 3.0: An XML Pipeline Language</span></a></cite><span class="deltaxml-old" style="background:#FF5555">); it needs to be connected to its pipeline input explicitly.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The pipeline that appears on the pipeline port is evaluated using the inputs and options specified on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step by means of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-option</span></code><span class="deltaxml-old" style="background:#FF5555"> elements, respectively.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> element is a special case of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:with-input</span></code><span class="deltaxml-old" style="background:#FF5555"> element for passing inputs to the pipeline being run.</span></p><p class="element-syntax element-syntax-language-construct"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:run-input</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">port</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">NCName</span></var><span class="deltaxml-old" style="background:#FF5555">  select? = </span><var><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></var><span class="deltaxml-old" style="background:#FF5555">  href? = { </span><var><span class="deltaxml-old" style="background:#FF5555">anyURI</span></var><span class="deltaxml-old" style="background:#FF5555"> }</span><span class="deltaxml-old" style="background:#FF5555">  pipe? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  primary? = </span><var><span class="deltaxml-old" style="background:#FF5555">boolean</span></var><span class="deltaxml-old" style="background:#FF5555">  exclude-inline-prefixes? = </span><var><span class="deltaxml-old" style="background:#FF5555">ExcludeInlinePrefixes</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    ((</span><a href="#p.empty"><span class="deltaxml-old" style="background:#FF5555">p:empty</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">       (</span><a href="#p.document"><span class="deltaxml-old" style="background:#FF5555">p:document</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">        </span><a href="#p.pipe"><span class="deltaxml-old" style="background:#FF5555">p:pipe</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">        </span><a href="#p.inline"><span class="deltaxml-old" style="background:#FF5555">p:inline</span></a><span class="deltaxml-old" style="background:#FF5555">)*) | </span><span class="deltaxml-old" style="background:#FF5555">     </span><var><span class="deltaxml-old" style="background:#FF5555">anyElement</span></var><span class="deltaxml-old" style="background:#FF5555">*)</span><span class="deltaxml-old" style="background:#FF5555">&lt;/p:run-input&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">Similarly, the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-option</span></code><span class="deltaxml-old" style="background:#FF5555"> element is a special case of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></code><span class="deltaxml-old" style="background:#FF5555"> element for passing options to the pipeline being run.</span></p><p class="element-syntax element-syntax-language-construct"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:run-option</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">name</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">EQName</span></var><span class="deltaxml-old" style="background:#FF5555">  as? = </span><var><span class="deltaxml-old" style="background:#FF5555">XPathSequenceType</span></var><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">select</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></var><span class="deltaxml-old" style="background:#FF5555">  collection? = </span><var><span class="deltaxml-old" style="background:#FF5555">boolean</span></var><span class="deltaxml-old" style="background:#FF5555">  href? = { </span><var><span class="deltaxml-old" style="background:#FF5555">anyURI</span></var><span class="deltaxml-old" style="background:#FF5555"> }</span><span class="deltaxml-old" style="background:#FF5555">  pipe? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  static? = </span><var><span class="deltaxml-old" style="background:#FF5555">boolean</span></var><span class="deltaxml-old" style="background:#FF5555">  exclude-inline-prefixes? = </span><var><span class="deltaxml-old" style="background:#FF5555">ExcludeInlinePrefixes</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    ((</span><a href="#p.empty"><span class="deltaxml-old" style="background:#FF5555">p:empty</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">       (</span><a href="#p.document"><span class="deltaxml-old" style="background:#FF5555">p:document</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">        </span><a href="#p.pipe"><span class="deltaxml-old" style="background:#FF5555">p:pipe</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">        </span><a href="#p.inline"><span class="deltaxml-old" style="background:#FF5555">p:inline</span></a><span class="deltaxml-old" style="background:#FF5555">)*) | </span><span class="deltaxml-old" style="background:#FF5555">     </span><var><span class="deltaxml-old" style="background:#FF5555">anyElement</span></var><span class="deltaxml-old" style="background:#FF5555">*)</span><span class="deltaxml-old" style="background:#FF5555">&lt;/p:run-option&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">In terms of binding inputs and options, these elements have the same syntax and semantics as </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:with-input</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></code><span class="deltaxml-old" style="background:#FF5555">. In addition, the boolean attribute </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><span class="deltaxml-old" style="background:#FF5555"> can be used on </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> to declare whether the respective port of the dynamically executed pipeline is expected to be the primary input port. If the attribute is omitted, it is assumed to be “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">” if there are multiple </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> connections and “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">” if there is exactly one </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> connection. </span><a id="err.inline.C0206&#34;"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0206"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0206</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the dynamically executed pipeline implicitly or explicitly declares a primary input port with a different name than implicitly or explicitly specified in the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> invocation. Input ports of the dynamically executed pipeline that are not declared with </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> invocation will receive a </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:empty</span></code><span class="deltaxml-old" style="background:#FF5555"> connection. Input ports that are declared in </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> but not in the dynamically executed pipeline will be silently ignored.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The context item used to evaluate expressions on </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-option</span></code><span class="deltaxml-old" style="background:#FF5555"> comes from the </span><em><span class="deltaxml-old" style="background:#FF5555">default readable port</span></em><span class="deltaxml-old" style="background:#FF5555"> of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step. Additionally, if </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-input</span></code><span class="deltaxml-old" style="background:#FF5555"> implicitly or explicitly identifies a primary input port, the default readable port will be connected to it if no explicit connection is provided.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Other than </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-option</span></code><span class="deltaxml-old" style="background:#FF5555"> accepts a boolean attribute </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">static</span></code><span class="deltaxml-old" style="background:#FF5555"> that defaults to “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">”. If it is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">”, the option value will be supplied to static analysis of the executed pipeline as a static option with the same name.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Options of the dynamically executed pipeline that are not provided by a </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-option</span></code><span class="deltaxml-old" style="background:#FF5555"> on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> invocation will be defaulted in the normal way (if the option is required, the invocation will fail, for example). Options that are provided by </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run-option</span></code><span class="deltaxml-old" style="background:#FF5555"> but not declared in the dynamically executed pipeline are silently ignored.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Each output port of the pipeline can appear as a same-named output port of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step. In order for this to happen, the port needs to be explicitly declared in the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step. In contrast to output declarations of compound steps or of </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:declare-pipeline</span></code><span class="deltaxml-old" style="background:#FF5555"> with a subpipeline, such an output declaration may not establish a connection to any port of another step or of the pipeline to be run.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the pipeline has an output that is not declared on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step, that output is discarded, and the corresponding port on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step does not exist. If the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> step declares an output port that is not provided by the pipeline, an empty sequence appears on that port.</span></p><p><a id="err.inline.C0207&#34;"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0207"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0207</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the dynamically executed pipeline implicitly or explicitly declares a primary output port with a different name than implicitly or explicitly specified in the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code><span class="deltaxml-old" style="background:#FF5555"> invocation.</span></p><section id="example-run" class="section"><div class="section-titlepage"><h3><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Example</span><a aria-label="§" class="self-link" href="#example-run"></a></h3></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">The following pipeline shows how </span><a href="#c.run"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code></a><span class="deltaxml-old" style="background:#FF5555"> might be used.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:xs="http://www.w3.org/2001/XMLSchema" version="3.0" name="sample-run-invocation"&gt; &lt;p:variable name="xsl-params" select="map{'foo': 'bar'}" as="map(xs:QName, item()*)"/&gt; &lt;p:variable name="assert-valid" select="false()" as="xs:boolean"/&gt; &lt;p:variable name="mode" as="xs:QName?" select="()"/&gt; &lt;p:variable name="template" as="xs:QName?" select="()"/&gt; &lt;p:run name="runme"&gt; &lt;p:with-input href="transform-n-validate.xpl"/&gt; &lt;p:run-option name="mode" select="$mode"/&gt; &lt;p:run-option name="template" select="$template"/&gt; &lt;p:run-option name="xslt-parameters" select="$xsl-params"/&gt; &lt;p:run-option name="assert-valid" select="$assert-valid"/&gt; &lt;p:run-input port="source" href="my.xml" primary="true"/&gt; &lt;p:run-input port="stylesheet" href="my.xsl"/&gt; &lt;p:run-input port="xsd" href="my.xsd"/&gt; &lt;p:output port="result" primary="true"/&gt; &lt;p:output port="report"/&gt; &lt;/p:run&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">With this pipeline in </span><code class="filename"><span class="deltaxml-old" style="background:#FF5555">transform-n-validate.xpl</span></code><span class="deltaxml-old" style="background:#FF5555">, the preceding step has the effect of running the pipeline with the dynamically constructed options.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:xs="http://www.w3.org/2001/XMLSchema" version="3.0" name="transform-n-validate"&gt; &lt;p:input port="source" primary="true" sequence="true"/&gt; &lt;p:input port="stylesheet"/&gt; &lt;p:input port="xsd"/&gt; &lt;p:option name="assert-valid" as="xs:boolean" select="false()"/&gt; &lt;p:option name="xslt-parameters" as="map(xs:QName, item()*)?"/&gt; &lt;p:option name="mode" as="xs:QName?"/&gt; &lt;p:option name="template" as="xs:QName?"/&gt; &lt;p:output port="result" primary="true"/&gt; &lt;p:output port="report" pipe="report@xsdval"/&gt; &lt;p:xslt&gt; &lt;p:with-option name="initial-mode" select="$mode"/&gt; &lt;p:with-option name="template-name" select="$template"/&gt; &lt;p:with-option name="parameters" select="$xslt-parameters"/&gt; &lt;p:with-input port="stylesheet" pipe="stylesheet"/&gt; &lt;/p:xslt&gt; &lt;p:validate-with-xml-schema name="xsdval"&gt; &lt;p:with-option name="assert-valid" select="$assert-valid"/&gt; &lt;p:with-input port="schema" pipe="xsd@transform-n-validate"/&gt; &lt;/p:validate-with-xml-schema&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">In practice, </span><a href="#c.run"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:run</span></code></a><span class="deltaxml-old" style="background:#FF5555"> might be more often used with dynamically constructed pipelines.</span></p></div></section><section id="c.run.19" class="section"><div class="section-titlepage"><h3><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Document properties</span><a aria-label="§" class="self-link" href="#"></a></h3></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">The extent to which document properties are preserved depends on the steps in the dynamically executed pipeline.</span></p></div></section></div></section><section id="library" class="section"><div class="section-titlepage"><h2><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Step library</span><a aria-label="§" class="self-link" href="#library"></a></h2></div><div class="content"><section id="c.run" class="section"><div class="section-titlepage"><h3><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1. </span></bdi><span class="deltaxml-new" style="background:#90EE90">p:run</span><a aria-label="§" class="self-link" href="#c.run"></a></h3></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step runs a dynamically loaded pipeline.</span></p><p class="element-syntax element-syntax-language-construct"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:run</span><br /><span class="deltaxml-new" style="background:#90EE90">  name? = </span><var><span class="deltaxml-new" style="background:#90EE90">NCName</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    (</span><a href="#p.with-input"><span class="deltaxml-new" style="background:#90EE90">p:with-input</span></a><span class="deltaxml-new" style="background:#90EE90">? &amp; </span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><a href="#p.run-input"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></a><span class="deltaxml-new" style="background:#90EE90">* &amp; </span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><a href="#p.run-option"><span class="deltaxml-new" style="background:#90EE90">p:run-option</span></a><span class="deltaxml-new" style="background:#90EE90">* &amp; </span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><a href="#p.output"><span class="deltaxml-new" style="background:#90EE90">p:output</span></a><span class="deltaxml-new" style="background:#90EE90">*)</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/p:run&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step has a single, anonymous input that accepts the pipeline to be run. Otherwise, it functions similar to an atomic step in that you can define input connections and option values for it, albeit not with the usual </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:with-input</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></code><span class="deltaxml-new" style="background:#90EE90"> connections.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step expects a single pipeline document on its anonymous input port (“pipeline port”). Independent of how the pipeline is provided, it </span><span class="rfc2119" id="c.run.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> have a </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute on its root element. </span><a id="err.inline.C0200&#34;"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0200"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0200</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the pipeline input to the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step is not a valid pipeline. The anonymous input port is not primary, although it is the only </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:input</span></code><span class="deltaxml-new" style="background:#90EE90"> port of </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90">. Therefore it will not automatically connect to the </span><em><span class="deltaxml-new" style="background:#90EE90">default readable port</span></em><span class="deltaxml-new" style="background:#90EE90"> (see </span><cite><a href="../xproc/#connections"><span class="deltaxml-new" style="background:#90EE90">Connections</span></a></cite><span class="deltaxml-new" style="background:#90EE90"> in </span><cite><a href="../xproc/"><span class="deltaxml-new" style="background:#90EE90">XProc 3.0: An XML Pipeline Language</span></a></cite><span class="deltaxml-new" style="background:#90EE90">); it needs to be connected to its pipeline input explicitly.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The pipeline that appears on the pipeline port is evaluated using the inputs and options specified on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step by means of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-option</span></code><span class="deltaxml-new" style="background:#90EE90"> elements, respectively.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> element is a special case of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:with-input</span></code><span class="deltaxml-new" style="background:#90EE90"> element for passing inputs to the pipeline being run.</span></p><p class="element-syntax element-syntax-language-construct"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:run-input</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">port</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">NCName</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  select? = </span><var><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  href? = { </span><var><span class="deltaxml-new" style="background:#90EE90">anyURI</span></var><span class="deltaxml-new" style="background:#90EE90"> }</span><br /><span class="deltaxml-new" style="background:#90EE90">  pipe? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  primary? = </span><var><span class="deltaxml-new" style="background:#90EE90">boolean</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  exclude-inline-prefixes? = </span><var><span class="deltaxml-new" style="background:#90EE90">ExcludeInlinePrefixes</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    ((</span><a href="#p.empty"><span class="deltaxml-new" style="background:#90EE90">p:empty</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">       (</span><a href="#p.document"><span class="deltaxml-new" style="background:#90EE90">p:document</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">        </span><a href="#p.pipe"><span class="deltaxml-new" style="background:#90EE90">p:pipe</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">        </span><a href="#p.inline"><span class="deltaxml-new" style="background:#90EE90">p:inline</span></a><span class="deltaxml-new" style="background:#90EE90">)*) | </span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><var><span class="deltaxml-new" style="background:#90EE90">anyElement</span></var><span class="deltaxml-new" style="background:#90EE90">*)</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/p:run-input&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">Similarly, the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-option</span></code><span class="deltaxml-new" style="background:#90EE90"> element is a special case of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></code><span class="deltaxml-new" style="background:#90EE90"> element for passing options to the pipeline being run.</span></p><p class="element-syntax element-syntax-language-construct"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:run-option</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">name</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">EQName</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  as? = </span><var><span class="deltaxml-new" style="background:#90EE90">XPathSequenceType</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">select</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  collection? = </span><var><span class="deltaxml-new" style="background:#90EE90">boolean</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  href? = { </span><var><span class="deltaxml-new" style="background:#90EE90">anyURI</span></var><span class="deltaxml-new" style="background:#90EE90"> }</span><br /><span class="deltaxml-new" style="background:#90EE90">  pipe? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  static? = </span><var><span class="deltaxml-new" style="background:#90EE90">boolean</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  exclude-inline-prefixes? = </span><var><span class="deltaxml-new" style="background:#90EE90">ExcludeInlinePrefixes</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    ((</span><a href="#p.empty"><span class="deltaxml-new" style="background:#90EE90">p:empty</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">       (</span><a href="#p.document"><span class="deltaxml-new" style="background:#90EE90">p:document</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">        </span><a href="#p.pipe"><span class="deltaxml-new" style="background:#90EE90">p:pipe</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">        </span><a href="#p.inline"><span class="deltaxml-new" style="background:#90EE90">p:inline</span></a><span class="deltaxml-new" style="background:#90EE90">)*) | </span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><var><span class="deltaxml-new" style="background:#90EE90">anyElement</span></var><span class="deltaxml-new" style="background:#90EE90">*)</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/p:run-option&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">In terms of binding inputs and options, these elements have the same syntax and semantics as </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:with-input</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></code><span class="deltaxml-new" style="background:#90EE90">. In addition, the boolean attribute </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><span class="deltaxml-new" style="background:#90EE90"> can be used on </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> to declare whether the respective port of the dynamically executed pipeline is expected to be the primary input port. If the attribute is omitted, it is assumed to be “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">” if there are multiple </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> connections and “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">” if there is exactly one </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> connection. </span><a id="err.inline.C0206&#34;"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0206"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0206</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the dynamically executed pipeline implicitly or explicitly declares a primary input port with a different name than implicitly or explicitly specified in the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> invocation. Input ports of the dynamically executed pipeline that are not declared with </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> invocation will receive a </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:empty</span></code><span class="deltaxml-new" style="background:#90EE90"> connection. Input ports that are declared in </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> but not in the dynamically executed pipeline will be silently ignored.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The context item used to evaluate expressions on </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-option</span></code><span class="deltaxml-new" style="background:#90EE90"> comes from the </span><em><span class="deltaxml-new" style="background:#90EE90">default readable port</span></em><span class="deltaxml-new" style="background:#90EE90"> of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step. Additionally, if </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-input</span></code><span class="deltaxml-new" style="background:#90EE90"> implicitly or explicitly identifies a primary input port, the default readable port will be connected to it if no explicit connection is provided.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Other than </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-option</span></code><span class="deltaxml-new" style="background:#90EE90"> accepts a boolean attribute </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">static</span></code><span class="deltaxml-new" style="background:#90EE90"> that defaults to “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">”. If it is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">”, the option value will be supplied to static analysis of the executed pipeline as a static option with the same name.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Options of the dynamically executed pipeline that are not provided by a </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-option</span></code><span class="deltaxml-new" style="background:#90EE90"> on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> invocation will be defaulted in the normal way (if the option is required, the invocation will fail, for example). Options that are provided by </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run-option</span></code><span class="deltaxml-new" style="background:#90EE90"> but not declared in the dynamically executed pipeline are silently ignored.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Each output port of the pipeline can appear as a same-named output port of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step. In order for this to happen, the port needs to be explicitly declared in the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step. In contrast to output declarations of compound steps or of </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:declare-pipeline</span></code><span class="deltaxml-new" style="background:#90EE90"> with a subpipeline, such an output declaration may not establish a connection to any port of another step or of the pipeline to be run.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the pipeline has an output that is not declared on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step, that output is discarded, and the corresponding port on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step does not exist. If the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> step declares an output port that is not provided by the pipeline, an empty sequence appears on that port.</span></p><p><a id="err.inline.C0207&#34;"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0207"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0207</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the dynamically executed pipeline implicitly or explicitly declares a primary output port with a different name than implicitly or explicitly specified in the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code><span class="deltaxml-new" style="background:#90EE90"> invocation.</span></p><section id="example-run" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Example</span><a aria-label="§" class="self-link" href="#example-run"></a></h4></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">The following pipeline shows how </span><a href="#c.run"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code></a><span class="deltaxml-new" style="background:#90EE90"> might be used.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:xs="http://www.w3.org/2001/XMLSchema" version="3.1" name="sample-run-invocation"&gt; &lt;p:variable name="xsl-params" select="map{'foo': 'bar'}" as="map(xs:QName, item()*)"/&gt; &lt;p:variable name="assert-valid" select="false()" as="xs:boolean"/&gt; &lt;p:variable name="mode" as="xs:QName?" select="()"/&gt; &lt;p:variable name="template" as="xs:QName?" select="()"/&gt; &lt;p:run name="runme"&gt; &lt;p:with-input href="transform-n-validate.xpl"/&gt; &lt;p:run-option name="mode" select="$mode"/&gt; &lt;p:run-option name="template" select="$template"/&gt; &lt;p:run-option name="xslt-parameters" select="$xsl-params"/&gt; &lt;p:run-option name="assert-valid" select="$assert-valid"/&gt; &lt;p:run-input port="source" href="my.xml" primary="true"/&gt; &lt;p:run-input port="stylesheet" href="my.xsl"/&gt; &lt;p:run-input port="xsd" href="my.xsd"/&gt; &lt;p:output port="result" primary="true"/&gt; &lt;p:output port="report"/&gt; &lt;/p:run&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">With this pipeline in </span><code class="filename"><span class="deltaxml-new" style="background:#90EE90">transform-n-validate.xpl</span></code><span class="deltaxml-new" style="background:#90EE90">, the preceding step has the effect of running the pipeline with the dynamically constructed options.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:xs="http://www.w3.org/2001/XMLSchema" version="3.1" name="transform-n-validate"&gt; &lt;p:input port="source" primary="true" sequence="true"/&gt; &lt;p:input port="stylesheet"/&gt; &lt;p:input port="xsd"/&gt; &lt;p:option name="assert-valid" as="xs:boolean" select="false()"/&gt; &lt;p:option name="xslt-parameters" as="map(xs:QName, item()*)?"/&gt; &lt;p:option name="mode" as="xs:QName?"/&gt; &lt;p:option name="template" as="xs:QName?"/&gt; &lt;p:output port="result" primary="true"/&gt; &lt;p:output port="report" pipe="report@xsdval"/&gt; &lt;p:xslt&gt; &lt;p:with-option name="initial-mode" select="$mode"/&gt; &lt;p:with-option name="template-name" select="$template"/&gt; &lt;p:with-option name="parameters" select="$xslt-parameters"/&gt; &lt;p:with-input port="stylesheet" pipe="stylesheet"/&gt; &lt;/p:xslt&gt; &lt;p:validate-with-xml-schema name="xsdval"&gt; &lt;p:with-option name="assert-valid" select="$assert-valid"/&gt; &lt;p:with-input port="schema" pipe="xsd@transform-n-validate"/&gt; &lt;/p:validate-with-xml-schema&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">In practice, </span><a href="#c.run"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:run</span></code></a><span class="deltaxml-new" style="background:#90EE90"> might be more often used with dynamically constructed pipelines.</span></p></div></section><section id="c.run.19" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.2. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Document properties</span><a aria-label="§" class="self-link" href="#"></a></h4></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">The extent to which document properties are preserved depends on the steps in the dynamically executed pipeline.</span></p></div></section></div></section></div></section><section id="errors" class="section"><div class="section-titlepage"><h2><bdi class="secno">3. </bdi>Step Errors<a aria-label="§" class="self-link" href="#errors"></a></h2></div><div class="content"><p>This step can raise <em class="glossterm"><a href="#dt-dynamic-error">dynamic errors</a></em>. </p><p><span id="dt-dynamic-error" class="termdef">[Definition: A <em class="glossterm">dynamic error</em> is one which occurs while a pipeline is being evaluated.]</span> Examples of dynamic errors include references to URIs that cannot be resolved, steps which fail, and pipelines that exhaust the capacity of an implementation (such as memory or disk space). For a more complete discussion of dynamic errors, see <cite><a href="../xproc/#dynamic-errors">Dynamic Errors</a></cite> in <cite><a href="../xproc/">XProc 3.0: An XML Pipeline Language</a></cite>. </p><p>If a step fails due to a dynamic error, failure propagates upwards until either a <code class="tag-element">p:try</code> is encountered or the entire pipeline fails. In other words, outside of a <code class="tag-element">p:try</code>, step failure causes the entire pipeline to fail.</p><p>The following errors can be raised by this step:</p><div id="step-error-summary"><dl class="errs"><dt id="err.C0200"><code class="errqname">err:XC0200</code></dt><dd><p>It is a dynamic error if the pipeline input to the p:run step is not a valid pipeline.</p><p>See: <a href="#err.inline.C0200">p:run</a></p></dd><dt id="err.C0206"><code class="errqname">err:XC0206</code></dt><dd><p>It is a dynamic error if the dynamically executed pipeline implicitly or explicitly declares a primary input port with a different name than implicitly or explicitly specified in the p:run invocation.</p><p>See: <a href="#err.inline.C0206">p:run</a></p></dd><dt id="err.C0207"><code class="errqname">err:XC0207</code></dt><dd><p>It is a dynamic error if the dynamically executed pipeline implicitly or explicitly declares a primary output port with a different name than implicitly or explicitly specified in the p:run invocation.</p><p>See: <a href="#err.inline.C0207">p:run</a></p></dd></dl></div></div></section><article id="conformance" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">A. </bdi>Conformance<a aria-label="§" class="self-link" href="#conformance"></a></h2></header><div class="content"><p>Conformant processors <span class="rfc2119" id="conformance.2.1">must</span> implement all of the features described in this specification except those that are explicitly identified as optional.</p><p>Some aspects of processor behavior are not completely specified; those features are either <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> or <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em>.</p><p><span id="dt-implementation-dependent" class="termdef">[Definition: An <em class="glossterm">implementation-dependent</em> feature is one where the implementation has discretion in how it is performed. Implementations are not required to document or explain how <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> features are performed.]</span></p><p><span id="dt-implementation-defined" class="termdef">[Definition: An <em class="glossterm">implementation-defined</em> feature is one where the implementation has discretion in how it is performed. Conformant implementations <span class="rfc2119" id="dt-implementation-defined.2">must</span> document how <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em> features are performed.]</span></p><section id="implementation-defined" class="section"><div class="section-titlepage"><h2><bdi class="secno">A.1. </bdi>Implementation-defined features<a aria-label="§" class="self-link" href="#implementation-defined"></a></h2></div><div class="content"><p>The following features are implementation-defined:</p><ol class="features"></ol></div></section></div></article><article class="appendix" id="references"><header class="appendix-titlepage"><h2><bdi class="secno">B. </bdi>References<a aria-label="§" class="self-link" href="#references"></a></h2></header><div class="content"><div class="bibliolist" id="references.2"><div id="xproc30" class="bibliomixed"><p><span class="deltaxml-old" style="background:#FF5555">[</span><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XProc 3.0</span></span><span class="deltaxml-old" style="background:#FF5555">] </span><a href="https://spec.xproc.org/3.0/xproc/"><span class="citetitle"><cite><span class="deltaxml-old" style="background:#FF5555">XProc 3.0: An XML Pipeline Language</span></cite></span></a><span class="deltaxml-old" style="background:#FF5555">. Norman Walsh, Achim Berndzen, Gerrit Imsieke and Erik Siegel, editors. </span></p></div><div id="xproc30-steps" class="bibliomixed"><p><span class="deltaxml-old" style="background:#FF5555">[</span><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XProc 3.0 Steps</span></span><span class="deltaxml-old" style="background:#FF5555">] </span><a href="https://spec.xproc.org/"><span class="citetitle"><cite><span class="deltaxml-old" style="background:#FF5555">XProc 3.0 Steps: An Introduction</span></cite></span></a><span class="deltaxml-old" style="background:#FF5555">. Norman Walsh, Achim Berndzen, Gerrit Imsieke and Erik Siegel, editors. </span></p></div><div id="xproc31" class="bibliomixed"><p><span class="deltaxml-new" style="background:#90EE90">[</span><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XProc 3.1</span></span><span class="deltaxml-new" style="background:#90EE90">] </span><a href="https://spec.xproc.org/lastcall-2024-08/head/xproc/"><span class="citetitle"><cite><span class="deltaxml-new" style="background:#90EE90">XProc 3.1: An XML Pipeline Language</span></cite></span></a><span class="deltaxml-new" style="background:#90EE90">. Norman Walsh, Achim Berndzen, Gerrit Imsieke and Erik Siegel, editors. </span></p></div></div></div></article><article id="glossary" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">C. </bdi>Glossary<a aria-label="§" class="self-link" href="#glossary"></a></h2></header><div class="content"><div class="glosslist"><dl><dt id="glossary.2.1" class="glossentry"><em class="glossterm"><a href="#dt-dynamic-error">dynamic error</a></em></dt><dd class="glossdef"><p>A <em class="firstterm">dynamic error</em> is one which occurs while a pipeline is being evaluated.</p></dd><dt id="glossary.2.2" class="glossentry"><em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em></dt><dd class="glossdef"><p>An <em class="firstterm">implementation-defined</em> feature is one where the implementation has discretion in how it is performed. Conformant implementations <span class="rfc2119" id="glossary.2.2.2.1.2">must</span> document how <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em> features are performed.</p></dd><dt id="glossary.2.3" class="glossentry"><em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em></dt><dd class="glossdef"><p>An <em class="firstterm">implementation-dependent</em> feature is one where the implementation has discretion in how it is performed. Implementations are not required to document or explain how <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> features are performed.</p></dd></dl></div></div></article><article id="ancillary-files" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">D. </bdi>Ancillary files<a aria-label="§" class="self-link" href="#ancillary-files"></a></h2></header><div class="content"><p>This specification includes by reference a number of ancillary files.</p><div class="variablelist"><dl><dt><span class="term"><a href="steps.xpl">steps.xpl</a></span></dt><dd><p>An XProc step library for the declared steps. </p></dd></dl></div></div></article></article><script src="js/prism.js"></script><script src="js/fixup.js"></script><script src="/js/scroll.js"></script></body></html>