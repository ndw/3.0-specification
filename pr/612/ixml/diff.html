<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><!--Generated by the DeltaXML.com xhtml-outfilter.xsl--><!--Using XSL Processor: Saxonica--><title>XProc -[[3.0]]- +[[3.1]]+: Invisible XML</title><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" /><link class="removeOnSave" crossorigin="anonymous" href="https://www.w3.org" rel="preconnect" /><link as="script" class="removeOnSave" href="js/fixup.js" rel="preload" /><link as="style" class="removeOnSave" href="css/base.css" rel="preload" /><link as="image" class="removeOnSave" href="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" rel="preload" /><link rel="stylesheet" href="css/cg-draft.css" /><link rel="stylesheet" href="css/respec.css" /><link rel="alternate" title="XML" href="specification.xml" /><meta name="generator" content="DocBook XSL 2.0 Stylesheets V2.5.0" /><meta name="description" content="Abstract This specification describes the p:ixml&#xA;step for&#xA;XProc 3.1: An XML Pipeline Language." /><link href="css/default.css" rel="stylesheet" type="text/css" /><link href="css/db-prism.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="css/base.css" /><link rel="stylesheet" type="text/css" href="css/xproc.css" /><link rel="stylesheet" type="text/css" href="css/print.css" media="print" /><script type="text/javascript" src="js/dbmodnizr.js"></script><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><link rel="stylesheet" href="/css/autodiff.css" /></head><body class="h-entry informative toc-sidebar"><div style="position:fixed; clear:both; top:0px" id="_autodiff_buttons"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a><a class="button" onclick="view('only')">
              View Only
            </a><a class="button" onclick="scroll_to('prev')">
              Previous
            </a><a class="button" onclick="scroll_to('next')">
              Next
            </a><span id="__autodiff__"></span></p></div><div class="head" id="spec.head"><a class="logo" href="https://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72" /></a><h1 class="title p-name" id="title">XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span>: Invisible XML</h1><h2><span class="deltaxml-old" style="background:#FF5555">Draft </span>Community Group Report <time class="dt-published" datetime="2024-08-20">20 August 2024</time></h2><div class="editors-draft"><span class="deltaxml-old" style="background:#FF5555">Editor's Draft at </span><time class="dt-timestamp" datetime="20240820T15:10:38Z"><span class="deltaxml-old" style="background:#FF5555">15:10 UTC</span></time><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="https://github.com/xproc//commit/577bcd228882c1af53ce0ba43c4110bca81d9cd4"><span class="deltaxml-old" style="background:#FF5555">build 49</span></a><span class="deltaxml-old" style="background:#FF5555">)</span></div><dl><dt>Latest editor’s draft:</dt><dd><a href="https://spec.xproc.org/master/head/ixml/">https://spec.xproc.org/master/head/ixml/</a></dd><dt>Editor:</dt><dd><span class="personname">Norman Walsh</span></dd><dt>Participate:</dt><dd><a href="http://github.com/xproc/3.0-steps">GitHub xproc/3.0-steps</a></dd><dd><a href="http://github.com/xproc/3.0-steps/issues">Report an issue</a></dd><dt>Changes:</dt><dd><a href="diff.html">Diff against current “status quo” draft</a></dd><dd><a href="http://github.com/xproc//commits/">Commits for this specification</a></dd></dl><p>This document is also available in these non-normative formats: <a href="specification.xml">XML</a> and HTML with automatic change markup courtesy of <a href="http://www.deltaxml.com/">DeltaXML</a>.</p><p class="copyright"><span style="display: none;" class="delete_version"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © <span class="years">2021</span> the Contributors to the <cite>XProc 3.0: Invisible XML</cite> specification, published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.</span><span style="display: none;" class="add_version"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © <span class="years">2021</span> the Contributors to the <cite>XProc 3.1: Invisible XML</cite> specification, published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.</span><span class="modify_version"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © <span class="years">2021</span> the Contributors to the <cite>XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span>: Invisible XML</cite> specification, published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available.</span></p><hr title="Separator for header" /><section class="introductory" id="abstract"><h2>Abstract</h2><p><span style="display: none;" class="delete_version">This specification describes the <code class="code">p:ixml</code> step for <em class="citetitle">XProc 3.0: An XML Pipeline Language</em>.</span><span style="display: none;" class="add_version">This specification describes the <code class="code">p:ixml</code> step for <em class="citetitle">XProc 3.1: An XML Pipeline Language</em>.</span><span class="modify_version">This specification describes the <code class="code">p:ixml</code> step for <em class="citetitle">XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span>: An XML Pipeline Language</em>.</span></p></section><section class="introductory" id="sotd"><h2>Status of this Document</h2><p><strong><span class="deltaxml-old" style="background:#FF5555">This document is an editor's draft that has no official standing.</span></strong></p><p>This specification was published by the <a href="https://www.w3.org/community/xproc-next/">XProc Next Community Group</a>. It is not a W3C Standard nor is it on the W3C Standards Track. Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply. Learn more about <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>. </p><p>If you wish to make comments regarding this document, please send them to <a href="mailto:xproc-dev@w3.org">xproc-dev@w3.org</a>. (<a href="mailto:xproc-dev-request@w3.org?subject=subscribe">subscribe</a>, <a href="https://lists.w3.org/Archives/Public/xproc-dev/">archives</a>). </p><div class="note editorial admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><div class="admonition-body"><p><span class="deltaxml-new" style="background:#90EE90">This draft is a “last call” draft. This version is stable and will not be updated. </span></p></div></div></section></div><div class="lists-of-titles"><nav id="toc"><h2 id="TableOfContents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#c.ixml"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">p:ixml</span></a><a class="tocxref" href="#library"><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Step library</span></a><ul class="toc"><li class="tocline"><a class="tocxref" href="#c.ixml"><bdi class="secno">2.1. </bdi><span class="deltaxml-old" style="background:#FF5555">Examples</span><span class="deltaxml-new" style="background:#90EE90">p:ixml</span></a><ul class="toc"><li class="tocline"><a class="tocxref" href="#example-parse-ixml"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.1. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Parsing an Invisible XML grammar</span></a><a class="tocxref" href="#example-ixml"><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Examples</span></a></li><li class="delete_version" style="display: none;"><a class="tocxref" href="#example-parse-date"><bdi class="secno">2.1.2. </bdi>Parsing a date</a></li><li class="tocline"><a class="tocxref" href="#example-parse-date"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Parsing a date</span></a></li><li class="delete_version" style="display: none;"><a class="tocxref" href="#example-parse-fail"><bdi class="secno">2.1.3. </bdi>Failed parses</a></li><li class="tocline"><a class="tocxref" href="#example-parse-fail"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.3. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Failed parses</span></a></li><li class="delete_version" style="display: none;"><a class="tocxref" href="#example-parse-ambiguous-1"><bdi class="secno">2.1.4. </bdi>Ambiguous parses</a></li><li class="tocline"><a class="tocxref" href="#example-parse-ambiguous-1"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.4. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Ambiguous parses</span></a></li><li class="delete_version" style="display: none;"><a class="tocxref" href="#example-parse-ambiguous-2"><bdi class="secno">2.1.5. </bdi>Ambiguous parse selection</a></li><li class="tocline"><a class="tocxref" href="#example-parse-ambiguous-2"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.5. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Ambiguous parse selection</span></a></li><li class="delete_version" style="display: none;"><a class="tocxref" href="#example-parse-ambiguous-3"><bdi class="secno">2.1.6. </bdi>Multiple ambiguous outputs</a></li><li class="tocline"><a class="tocxref" href="#example-parse-ambiguous-3"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.6. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Multiple ambiguous outputs</span></a></li></ul></li><li class="delete_version" style="display: none;"><a class="tocxref" href="#c.ixml.9"><bdi class="secno">2.2. </bdi>Document properties</a></li><li class="tocline"><a class="tocxref" href="#c.ixml.9"><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Document properties</span></a></li></ul></li><li class="tocline"><a class="tocxref" href="#errors"><bdi class="secno">3. </bdi>Step Errors</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">A. </bdi>Conformance</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#implementation-defined"><bdi class="secno">A.1. </bdi>Implementation-defined features</a></li><li class="tocline"><a class="tocxref" href="#implementation-dependent"><bdi class="secno">A.2. </bdi>Implementation-dependent features</a></li></ul></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>References</a></li><li class="tocline"><a class="tocxref" href="#glossary"><bdi class="secno">C. </bdi>Glossary</a></li><li class="tocline"><a class="tocxref" href="#ancillary-files"><bdi class="secno">D. </bdi>Ancillary files</a></li></ol></nav></div><article class="specification"><section class="section" id="introduction"><div class="section-titlepage"><h2><bdi class="secno">1. </bdi>Introduction<a aria-label="§" class="self-link" href="#introduction"></a></h2></div><div class="content"><p>This specification describes the <code class="code">p:ixml</code> XProc step. A machine-readable description of this step may be found in <a href="steps.xpl">steps.xpl</a>. </p><p>Familarity with the general nature of [<a><span style="display: none;" class="delete_version" href="#xproc30"><span class="abbrev">XProc 3.0</span></span><span style="display: none;" class="add_version" href="#xproc31"><span class="abbrev">XProc 3.1</span></span><span class="modify_version" href="#xproc31"><span class="abbrev">XProc <span class="deltaxml-old" style="background:#FF5555">3.0</span><span class="deltaxml-new" style="background:#90EE90">3.1</span></span></span></a>] steps is assumed<span class="deltaxml-old" style="background:#FF5555">; for background details, see [</span><a href="#xproc30-steps"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XProc 3.0 Steps</span></span></a><span class="deltaxml-old" style="background:#FF5555">]</span>.</p></div></section><section id="c.ixml" class="section"><div class="section-titlepage"><h2><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">p:ixml</span><a aria-label="§" class="self-link" href="#c.ixml"></a></h2></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:ixml</span></code><span class="deltaxml-old" style="background:#FF5555"> step performs Invisible XML processing per [</span><a href="#invisible-xml"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Invisible XML</span></span></a><span class="deltaxml-old" style="background:#FF5555">]. It transforms a non-XML input into XML by applying the specified Invisible XML grammar.</span></p><div class="declare-step"><p><span class="deltaxml-old" style="background:#FF5555">Summary</span></p><table class="tableaux"><thead><tr><th class="port"><span class="deltaxml-old" style="background:#FF5555">Input port</span></th><th class="check"><span class="deltaxml-old" style="background:#FF5555">Primary</span></th><th class="check"><span class="deltaxml-old" style="background:#FF5555">Sequence</span></th><th><span class="deltaxml-old" style="background:#FF5555">Content types</span></th></tr></thead><tbody><tr><td><a href="#port.inline.grammar-1"><span class="deltaxml-old" style="background:#FF5555">grammar</span></a></td><td class="check"><span class="deltaxml-old" style="background:#FF5555"> </span></td><td class="check"><span class="deltaxml-old" style="background:#FF5555">✔ </span></td><td><span class="deltaxml-old" style="background:#FF5555">text xml </span></td></tr><tr><td class="primary"><a href="#port.inline.source-1"><span class="deltaxml-old" style="background:#FF5555">source</span></a></td><td class="check"><span class="deltaxml-old" style="background:#FF5555">✔ </span></td><td class="check"><span class="deltaxml-old" style="background:#FF5555"> </span></td><td><span class="deltaxml-old" style="background:#FF5555">any -xml -html </span></td></tr></tbody></table><table class="tableaux"><thead><tr><th class="port"><span class="deltaxml-old" style="background:#FF5555">Output port</span></th><th class="check"><span class="deltaxml-old" style="background:#FF5555">Primary</span></th><th class="check"><span class="deltaxml-old" style="background:#FF5555">Sequence</span></th><th><span class="deltaxml-old" style="background:#FF5555">Content types</span></th></tr></thead><tbody><tr><td class="primary"><a href="#port.inline.result-1"><span class="deltaxml-old" style="background:#FF5555">result</span></a></td><td class="check"><span class="deltaxml-old" style="background:#FF5555">✔ </span></td><td class="check"><span class="deltaxml-old" style="background:#FF5555">✔ </span></td><td><span class="deltaxml-old" style="background:#FF5555">any </span></td></tr></tbody></table><table class="tableaux"><thead><tr><th><span class="deltaxml-old" style="background:#FF5555">Option name</span></th><th><span class="deltaxml-old" style="background:#FF5555">Type</span></th><th><span class="deltaxml-old" style="background:#FF5555">Default value</span></th></tr></thead><tbody><tr><td><a href="#opt.inline.fail-on-error-1"><span class="deltaxml-old" style="background:#FF5555">fail-on-error</span></a></td><td><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></td><td><span class="deltaxml-old" style="background:#FF5555">true()</span></td></tr><tr><td><a href="#opt.inline.parameters-1"><span class="deltaxml-old" style="background:#FF5555">parameters</span></a></td><td><span class="deltaxml-old" style="background:#FF5555">map(xs:QName, item()*)?</span></td><td><span class="deltaxml-old" style="background:#FF5555">()</span></td></tr></tbody></table><details><summary><span class="deltaxml-old" style="background:#FF5555">Errors</span></summary><table class="tableaux"><thead><tr><th><span class="deltaxml-old" style="background:#FF5555">Error code</span></th><th><span class="deltaxml-old" style="background:#FF5555">Description</span></th></tr></thead><tbody><tr><td class="errcode"><a href="#err.inline.C0205&#34;"><span class="deltaxml-old" style="background:#FF5555">err:XC0205</span></a></td><td class="description"><span class="deltaxml-old" style="background:#FF5555">It is a dynamic error if the source document cannot be parsed by the provided grammar.</span></td></tr><tr><td class="errcode"><a href="#err.inline.C0211&#34;"><span class="deltaxml-old" style="background:#FF5555">err:XC0211</span></a></td><td class="description"><span class="deltaxml-old" style="background:#FF5555">It is a dynamic error if more than one document appears on the grammar port.</span></td></tr><tr><td class="errcode"><a href="#err.inline.C0212&#34;"><span class="deltaxml-old" style="background:#FF5555">err:XC0212</span></a></td><td class="description"><span class="deltaxml-old" style="background:#FF5555">It is a dynamic error if the grammar provided is not a valid Invisible XML grammar.</span></td></tr></tbody></table></details><details><summary><span class="deltaxml-old" style="background:#FF5555">Implementation details</span></summary><table class="tableaux"><thead><tr><th><span class="deltaxml-old" style="background:#FF5555">Implementation</span></th><th><span class="deltaxml-old" style="background:#FF5555">Description</span></th></tr></thead><tbody><tr><td><a href="#impl-1"><span class="deltaxml-old" style="background:#FF5555">Defined</span></a></td><td class="description"><span class="deltaxml-old" style="background:#FF5555">It is implementation-defined if other result formats are possible.</span></td></tr><tr><td><a href="#impl-2"><span class="deltaxml-old" style="background:#FF5555">Defined</span></a></td><td class="description"><span class="deltaxml-old" style="background:#FF5555">The parameters are implementation-defined.</span></td></tr></tbody></table></details><details><summary><span class="deltaxml-old" style="background:#FF5555">Declaration</span></summary><p class="element-syntax element-syntax-declare-step"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:ixml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">grammar</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">text xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">any -xml -html</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">any</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName, item()*)?</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">fail-on-error</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">true()</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p></details></div><p><span class="deltaxml-old" style="background:#FF5555">If no grammar is provided on the </span><a id="port.inline.grammar-1"></a><code class="port"><span class="deltaxml-old" style="background:#FF5555">grammar</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the grammar for Invisible XML is assumed. If an XML or text grammar is provided it </span><span class="rfc2119" id="c.ixml.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an Invisible XML grammar. </span><a id="err.inline.C0212&#34;"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0212"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0212</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the grammar provided is not a valid Invisible XML grammar. </span><a id="err.inline.C0211&#34;"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0211"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0211</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if more than one document appears on the </span><a id="port.inline.grammar-2"></a><code class="port"><span class="deltaxml-old" style="background:#FF5555">grammar</span></code><span class="deltaxml-old" style="background:#FF5555"> port.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><a id="port.inline.source-1"></a><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> to be processed is usually text, but there’s nothing in principle that prevents an Invisible XML grammar from applying to an arbitrary sequence of characters.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><a id="port.inline.result-1"></a><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="rfc2119" id="c.ixml.6.2"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be XML. </span><span id="impl-1"><span class="deltaxml-old" style="background:#FF5555">It is </span><em class="glossterm"><a href="#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a></em><span class="deltaxml-old" style="background:#FF5555"> if other result formats are possible.</span></span><span class="deltaxml-old" style="background:#FF5555"> (An implementation might, for example, provide a way for the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:ixml</span></code><span class="deltaxml-old" style="background:#FF5555"> step to compile an Invisible XML grammar into some format that can be processed more efficiently.)</span></p><div class="itemizedlist"><ul><li><p><span id="impl-2"><span class="deltaxml-old" style="background:#FF5555">The </span><a id="opt.inline.parameters-1"></a><code class="option"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><span class="deltaxml-old" style="background:#FF5555"> are </span><em class="glossterm"><a href="#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a></em><span class="deltaxml-old" style="background:#FF5555">.</span></span><span class="deltaxml-old" style="background:#FF5555"> An implementation might provide parameters to select among different ambiguous parses or choose alternate representations.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">If </span><a id="opt.inline.fail-on-error-1"></a><code class="option"><span class="deltaxml-old" style="background:#FF5555">fail-on-error</span></code><span class="deltaxml-old" style="background:#FF5555"> is </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, the step will raise an error if the input cannot be parsed by the grammar. </span><a id="err.inline.C0205&#34;"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0205"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0205</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the source document cannot be parsed by the provided grammar. If </span><a id="opt.inline.fail-on-error-2"></a><code class="option"><span class="deltaxml-old" style="background:#FF5555">fail-on-error</span></code><span class="deltaxml-old" style="background:#FF5555"> is </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">, no error will be raised. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The Invisible XML specification provides a mechanism to identify failed parses in the output.</span></p></li></ul></div><section id="example-ixml" class="section"><div class="section-titlepage"><h3><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Examples</span><a aria-label="§" class="self-link" href="#example-ixml"></a></h3></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">Several examples demonstrate features of the step.</span></p><section id="example-parse-ixml" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.1. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Parsing an Invisible XML grammar</span><a aria-label="§" class="self-link" href="#example-parse-ixml"></a></h4></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">In this first example, no grammar is provided, so the pipeline parses the Invisible XML grammar on the </span><a id="port.inline.source-2"></a><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port and returns its XML representation:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml&gt; &lt;p:with-input port="grammar"&gt;&lt;p:empty /&gt;&lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt; date: s?, day, s, month, (s, year)? . -s: -" "+ . day: digit, digit? . -digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9". month: "January"; "February"; "March"; "April"; "May"; "June"; "July"; "August"; "September"; "October"; "November"; "December". year: (digit, digit)?, digit, digit . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">This would produce an XML version of the grammar:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;ixml&gt; &lt;rule name="date"&gt; &lt;alt&gt; &lt;option&gt; &lt;nonterminal name="s"/&gt; &lt;/option&gt; &lt;nonterminal name="day"/&gt; &lt;nonterminal name="s"/&gt; &lt;nonterminal name="month"/&gt; &lt;option&gt; &lt;alts&gt; &lt;alt&gt; &lt;nonterminal name="s"/&gt; &lt;nonterminal name="year"/&gt; &lt;/alt&gt; &lt;/alts&gt; &lt;/option&gt; &lt;/alt&gt; &lt;/rule&gt; &lt;!-- … remaining rules elided for brevity … --&gt; &lt;/ixml&gt;</span></code></pre></div></section><section id="example-parse-date" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Parsing a date</span><a aria-label="§" class="self-link" href="#example-parse-date"></a></h4></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">If the grammar is provided on the </span><a id="port.inline.grammar-3"></a><code class="port"><span class="deltaxml-old" style="background:#FF5555">grammar</span></code><span class="deltaxml-old" style="background:#FF5555"> port, it can be used to parse input, the string “31 December 2021” in this case:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; date: s?, day, s, month, (s, year)? . -s: -" "+ . day: digit, digit? . -digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9". month: "January"; "February"; "March"; "April"; "May"; "June"; "July"; "August"; "September"; "October"; "November"; "December". year: (digit, digit)?, digit, digit . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;31 December 2021&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">This would produce an XML version of the date:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;date&gt;&lt;day&gt;31&lt;/day&gt;&lt;month&gt;December&lt;/month&gt;&lt;year&gt;2021&lt;/year&gt;&lt;/date&gt;</span></code></pre></div></section><section id="example-parse-fail" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.3. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Failed parses</span><a aria-label="§" class="self-link" href="#example-parse-fail"></a></h4></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">If a parse fails, the implementation </span><span class="rfc2119" id="example-parse-fail.2.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> indicate this, but it may also provide information about where the processing failed.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml fail-on-error="false"&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; date: s?, day, s, month, (s, year)? . -s: -" "+ . day: digit, digit? . -digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9". month: "January"; "February"; "March"; "April"; "May"; "June"; "July"; "August"; "September"; "October"; "November"; "December". year: (digit, digit)?, digit, digit . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;31 Mumble 2021&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">Here the output might be something like this:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;error xmlns:ixml="http://invisiblexml.org/NS" xmlns:ex="http://example.com/NS" ixml:state="failed" ex:lastChar="4"&gt; &lt;parse&gt; month -&gt; • M a r c h month -&gt; M • a r c h &lt;/parse&gt; &lt;parse&gt; month -&gt; • M a y month -&gt; M • a y &lt;/parse&gt; &lt;/error&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">In the case of failure, Invisible XML requires that the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">ixml:state</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute appear on the root element containing the token “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">failed</span></code><span class="deltaxml-old" style="background:#FF5555">”. It doesn’t constrain the implementation’s choice of the root element or the content of the document. </span></p></div></section><section id="example-parse-ambiguous-1" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.4. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Ambiguous parses</span><a aria-label="§" class="self-link" href="#example-parse-ambiguous-1"></a></h4></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">An ixml grammar may be ambiguous. In the grammar below, there are three different possible ways to parse the input. By default, one of them is returned. </span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.0"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; letters: X, (A; B; C) . A: digits . B: digits . C: digits . X: "a" . digits: ["0"-"9"]+ . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">This might return any one of these parses:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;C&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/C&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">or</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">or</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;B&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/B&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">All are equally correct.</span></p></div></section><section id="example-parse-ambiguous-2" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.5. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Ambiguous parse selection</span><a aria-label="§" class="self-link" href="#example-parse-ambiguous-2"></a></h4></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">An implementation might provide a parameter to allow the author to select a particular parse: </span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:ex="http://example.com/" version="3.0"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml parameters="map{'ex:select':2}"&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; letters: X, (A; B; C) . A: digits . B: digits . C: digits . X: "a" . digits: ["0"-"9"]+ . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">This might return:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</span></code></pre></div></section><section id="example-parse-ambiguous-3" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.1.6. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Multiple ambiguous outputs</span><a aria-label="§" class="self-link" href="#example-parse-ambiguous-3"></a></h4></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">Or a processor might provide a parameter to return all of the parses.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:ex="http://example.com/" version="3.0"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml parameters="map{'ex:select':'all'}"&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; letters: X, (A; B; C) . A: digits . B: digits . C: digits . X: "a" . digits: ["0"-"9"]+ . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">This might return three documents:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-old" style="background:#FF5555">&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;C&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/C&gt;&lt;/letters&gt; &lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;B&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/B&gt;&lt;/letters&gt; &lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">As before, there is nothing standardized about the results in this case.</span></p></div></section></div></section><section id="c.ixml.9" class="section"><div class="section-titlepage"><h3><bdi class="secno"><span class="deltaxml-old" style="background:#FF5555">2.2. </span></bdi><span class="deltaxml-old" style="background:#FF5555">Document properties</span><a aria-label="§" class="self-link" href="#"></a></h3></div><div class="content"><p><span class="deltaxml-old" style="background:#FF5555">No document properties are preserved.</span></p></div></section></div></section><section id="library" class="section"><div class="section-titlepage"><h2><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Step library</span><a aria-label="§" class="self-link" href="#library"></a></h2></div><div class="content"><section id="c.ixml" class="section"><div class="section-titlepage"><h3><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1. </span></bdi><span class="deltaxml-new" style="background:#90EE90">p:ixml</span><a aria-label="§" class="self-link" href="#c.ixml"></a></h3></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:ixml</span></code><span class="deltaxml-new" style="background:#90EE90"> step performs Invisible XML processing per [</span><a href="#invisible-xml"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Invisible XML</span></span></a><span class="deltaxml-new" style="background:#90EE90">]. It transforms a non-XML input into XML by applying the specified Invisible XML grammar.</span></p><div class="declare-step"><p><span class="deltaxml-new" style="background:#90EE90">Summary</span></p><table class="tableaux"><thead><tr><th class="port"><span class="deltaxml-new" style="background:#90EE90">Input port</span></th><th class="check"><span class="deltaxml-new" style="background:#90EE90">Primary</span></th><th class="check"><span class="deltaxml-new" style="background:#90EE90">Sequence</span></th><th><span class="deltaxml-new" style="background:#90EE90">Content types</span></th></tr></thead><tbody><tr><td><a href="#port.inline.grammar-1"><span class="deltaxml-new" style="background:#90EE90">grammar</span></a></td><td class="check"><span class="deltaxml-new" style="background:#90EE90"> </span></td><td class="check"><span class="deltaxml-new" style="background:#90EE90">✔ </span></td><td><span class="deltaxml-new" style="background:#90EE90">text xml </span></td></tr><tr><td class="primary"><a href="#port.inline.source-1"><span class="deltaxml-new" style="background:#90EE90">source</span></a></td><td class="check"><span class="deltaxml-new" style="background:#90EE90">✔ </span></td><td class="check"><span class="deltaxml-new" style="background:#90EE90"> </span></td><td><span class="deltaxml-new" style="background:#90EE90">any -xml -html </span></td></tr></tbody></table><table class="tableaux"><thead><tr><th class="port"><span class="deltaxml-new" style="background:#90EE90">Output port</span></th><th class="check"><span class="deltaxml-new" style="background:#90EE90">Primary</span></th><th class="check"><span class="deltaxml-new" style="background:#90EE90">Sequence</span></th><th><span class="deltaxml-new" style="background:#90EE90">Content types</span></th></tr></thead><tbody><tr><td class="primary"><a href="#port.inline.result-1"><span class="deltaxml-new" style="background:#90EE90">result</span></a></td><td class="check"><span class="deltaxml-new" style="background:#90EE90">✔ </span></td><td class="check"><span class="deltaxml-new" style="background:#90EE90">✔ </span></td><td><span class="deltaxml-new" style="background:#90EE90">any </span></td></tr></tbody></table><table class="tableaux"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Option name</span></th><th><span class="deltaxml-new" style="background:#90EE90">Type</span></th><th><span class="deltaxml-new" style="background:#90EE90">Default value</span></th></tr></thead><tbody><tr><td><a href="#opt.inline.fail-on-error-1"><span class="deltaxml-new" style="background:#90EE90">fail-on-error</span></a></td><td><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></td><td><span class="deltaxml-new" style="background:#90EE90">true()</span></td></tr><tr><td><a href="#opt.inline.parameters-1"><span class="deltaxml-new" style="background:#90EE90">parameters</span></a></td><td><span class="deltaxml-new" style="background:#90EE90">map(xs:QName, item()*)?</span></td><td><span class="deltaxml-new" style="background:#90EE90">()</span></td></tr></tbody></table><details><summary><span class="deltaxml-new" style="background:#90EE90">Errors</span></summary><table class="tableaux"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Error code</span></th><th><span class="deltaxml-new" style="background:#90EE90">Description</span></th></tr></thead><tbody><tr><td class="errcode"><a href="#err.inline.C0205&#34;"><span class="deltaxml-new" style="background:#90EE90">err:XC0205</span></a></td><td class="description"><span class="deltaxml-new" style="background:#90EE90">It is a dynamic error if the source document cannot be parsed by the provided grammar.</span></td></tr><tr><td class="errcode"><a href="#err.inline.C0211&#34;"><span class="deltaxml-new" style="background:#90EE90">err:XC0211</span></a></td><td class="description"><span class="deltaxml-new" style="background:#90EE90">It is a dynamic error if more than one document appears on the grammar port.</span></td></tr><tr><td class="errcode"><a href="#err.inline.C0212&#34;"><span class="deltaxml-new" style="background:#90EE90">err:XC0212</span></a></td><td class="description"><span class="deltaxml-new" style="background:#90EE90">It is a dynamic error if the grammar provided is not a valid Invisible XML grammar.</span></td></tr></tbody></table></details><details><summary><span class="deltaxml-new" style="background:#90EE90">Implementation details</span></summary><table class="tableaux"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Implementation</span></th><th><span class="deltaxml-new" style="background:#90EE90">Description</span></th></tr></thead><tbody><tr><td><a href="#impl-1"><span class="deltaxml-new" style="background:#90EE90">Defined</span></a></td><td class="description"><span class="deltaxml-new" style="background:#90EE90">It is implementation-defined if other result formats are possible.</span></td></tr><tr><td><a href="#impl-2"><span class="deltaxml-new" style="background:#90EE90">Defined</span></a></td><td class="description"><span class="deltaxml-new" style="background:#90EE90">The parameters are implementation-defined.</span></td></tr></tbody></table></details><details><summary><span class="deltaxml-new" style="background:#90EE90">Declaration</span></summary><p class="element-syntax element-syntax-declare-step"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:ixml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">grammar</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">text xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">any -xml -html</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">any</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName, item()*)?</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">fail-on-error</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">true()</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p></details></div><p><span class="deltaxml-new" style="background:#90EE90">If no grammar is provided on the </span><a id="port.inline.grammar-1"></a><code class="port"><span class="deltaxml-new" style="background:#90EE90">grammar</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the grammar for Invisible XML is assumed. If an XML or text grammar is provided it </span><span class="rfc2119" id="c.ixml.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an Invisible XML grammar. </span><a id="err.inline.C0212&#34;"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0212"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0212</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the grammar provided is not a valid Invisible XML grammar. </span><a id="err.inline.C0211&#34;"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0211"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0211</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if more than one document appears on the </span><a id="port.inline.grammar-2"></a><code class="port"><span class="deltaxml-new" style="background:#90EE90">grammar</span></code><span class="deltaxml-new" style="background:#90EE90"> port.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><a id="port.inline.source-1"></a><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> to be processed is usually text, but there’s nothing in principle that prevents an Invisible XML grammar from applying to an arbitrary sequence of characters.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><a id="port.inline.result-1"></a><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="rfc2119" id="c.ixml.6.2"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be XML. </span><span id="impl-1"><span class="deltaxml-new" style="background:#90EE90">It is </span><em class="glossterm"><a href="#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a></em><span class="deltaxml-new" style="background:#90EE90"> if other result formats are possible.</span></span><span class="deltaxml-new" style="background:#90EE90"> (An implementation might, for example, provide a way for the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:ixml</span></code><span class="deltaxml-new" style="background:#90EE90"> step to compile an Invisible XML grammar into some format that can be processed more efficiently.)</span></p><div class="itemizedlist"><ul><li><p><span id="impl-2"><span class="deltaxml-new" style="background:#90EE90">The </span><a id="opt.inline.parameters-1"></a><code class="option"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><span class="deltaxml-new" style="background:#90EE90"> are </span><em class="glossterm"><a href="#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a></em><span class="deltaxml-new" style="background:#90EE90">.</span></span><span class="deltaxml-new" style="background:#90EE90"> An implementation might provide parameters to select among different ambiguous parses or choose alternate representations.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">If </span><a id="opt.inline.fail-on-error-1"></a><code class="option"><span class="deltaxml-new" style="background:#90EE90">fail-on-error</span></code><span class="deltaxml-new" style="background:#90EE90"> is </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, the step will raise an error if the input cannot be parsed by the grammar. </span><a id="err.inline.C0205&#34;"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0205"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0205</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the source document cannot be parsed by the provided grammar. If </span><a id="opt.inline.fail-on-error-2"></a><code class="option"><span class="deltaxml-new" style="background:#90EE90">fail-on-error</span></code><span class="deltaxml-new" style="background:#90EE90"> is </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">, no error will be raised. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The Invisible XML specification provides a mechanism to identify failed parses in the output.</span></p></li></ul></div><section id="example-ixml" class="section"><div class="section-titlepage"><h4><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Examples</span><a aria-label="§" class="self-link" href="#example-ixml"></a></h4></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">Several examples demonstrate features of the step.</span></p><section id="example-parse-ixml" class="section"><div class="section-titlepage"><h5><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1.1. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Parsing an Invisible XML grammar</span><a aria-label="§" class="self-link" href="#example-parse-ixml"></a></h5></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">In this first example, no grammar is provided, so the pipeline parses the Invisible XML grammar on the </span><a id="port.inline.source-2"></a><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port and returns its XML representation:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.1"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml&gt; &lt;p:with-input port="grammar"&gt;&lt;p:empty /&gt;&lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt; date: s?, day, s, month, (s, year)? . -s: -" "+ . day: digit, digit? . -digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9". month: "January"; "February"; "March"; "April"; "May"; "June"; "July"; "August"; "September"; "October"; "November"; "December". year: (digit, digit)?, digit, digit . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">This would produce an XML version of the grammar:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;ixml&gt; &lt;rule name="date"&gt; &lt;alt&gt; &lt;option&gt; &lt;nonterminal name="s"/&gt; &lt;/option&gt; &lt;nonterminal name="day"/&gt; &lt;nonterminal name="s"/&gt; &lt;nonterminal name="month"/&gt; &lt;option&gt; &lt;alts&gt; &lt;alt&gt; &lt;nonterminal name="s"/&gt; &lt;nonterminal name="year"/&gt; &lt;/alt&gt; &lt;/alts&gt; &lt;/option&gt; &lt;/alt&gt; &lt;/rule&gt; &lt;!-- … remaining rules elided for brevity … --&gt; &lt;/ixml&gt;</span></code></pre></div></section><section id="example-parse-date" class="section"><div class="section-titlepage"><h5><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1.2. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Parsing a date</span><a aria-label="§" class="self-link" href="#example-parse-date"></a></h5></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">If the grammar is provided on the </span><a id="port.inline.grammar-3"></a><code class="port"><span class="deltaxml-new" style="background:#90EE90">grammar</span></code><span class="deltaxml-new" style="background:#90EE90"> port, it can be used to parse input, the string “31 December 2021” in this case:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.1"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; date: s?, day, s, month, (s, year)? . -s: -" "+ . day: digit, digit? . -digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9". month: "January"; "February"; "March"; "April"; "May"; "June"; "July"; "August"; "September"; "October"; "November"; "December". year: (digit, digit)?, digit, digit . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;31 December 2021&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">This would produce an XML version of the date:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;date&gt;&lt;day&gt;31&lt;/day&gt;&lt;month&gt;December&lt;/month&gt;&lt;year&gt;2021&lt;/year&gt;&lt;/date&gt;</span></code></pre></div></section><section id="example-parse-fail" class="section"><div class="section-titlepage"><h5><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1.3. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Failed parses</span><a aria-label="§" class="self-link" href="#example-parse-fail"></a></h5></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">If a parse fails, the implementation </span><span class="rfc2119" id="example-parse-fail.2.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> indicate this, but it may also provide information about where the processing failed.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.1"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml fail-on-error="false"&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; date: s?, day, s, month, (s, year)? . -s: -" "+ . day: digit, digit? . -digit: "0"; "1"; "2"; "3"; "4"; "5"; "6"; "7"; "8"; "9". month: "January"; "February"; "March"; "April"; "May"; "June"; "July"; "August"; "September"; "October"; "November"; "December". year: (digit, digit)?, digit, digit . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;31 Mumble 2021&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">Here the output might be something like this:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;error xmlns:ixml="http://invisiblexml.org/NS" xmlns:ex="http://example.com/NS" ixml:state="failed" ex:lastChar="4"&gt; &lt;parse&gt; month -&gt; • M a r c h month -&gt; M • a r c h &lt;/parse&gt; &lt;parse&gt; month -&gt; • M a y month -&gt; M • a y &lt;/parse&gt; &lt;/error&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">In the case of failure, Invisible XML requires that the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">ixml:state</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute appear on the root element containing the token “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">failed</span></code><span class="deltaxml-new" style="background:#90EE90">”. It doesn’t constrain the implementation’s choice of the root element or the content of the document. </span></p></div></section><section id="example-parse-ambiguous-1" class="section"><div class="section-titlepage"><h5><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1.4. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Ambiguous parses</span><a aria-label="§" class="self-link" href="#example-parse-ambiguous-1"></a></h5></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">An ixml grammar may be ambiguous. In the grammar below, there are three different possible ways to parse the input. By default, one of them is returned. </span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="3.1"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; letters: X, (A; B; C) . A: digits . B: digits . C: digits . X: "a" . digits: ["0"-"9"]+ . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">This might return any one of these parses:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;C&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/C&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">or</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">or</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;letters ixml:state="ambiguous" xmlns:ixml="http://invisiblexml.org/NS"&gt;&lt;X&gt;a&lt;/X&gt;&lt;B&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/B&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">All are equally correct.</span></p></div></section><section id="example-parse-ambiguous-2" class="section"><div class="section-titlepage"><h5><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1.5. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Ambiguous parse selection</span><a aria-label="§" class="self-link" href="#example-parse-ambiguous-2"></a></h5></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">An implementation might provide a parameter to allow the author to select a particular parse: </span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:ex="http://example.com/" version="3.1"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml parameters="map{'ex:select':2}"&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; letters: X, (A; B; C) . A: digits . B: digits . C: digits . X: "a" . digits: ["0"-"9"]+ . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">This might return:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</span></code></pre></div></section><section id="example-parse-ambiguous-3" class="section"><div class="section-titlepage"><h5><bdi class="secno"><span class="deltaxml-new" style="background:#90EE90">2.1.1.6. </span></bdi><span class="deltaxml-new" style="background:#90EE90">Multiple ambiguous outputs</span><a aria-label="§" class="self-link" href="#example-parse-ambiguous-3"></a></h5></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">Or a processor might provide a parameter to return all of the parses.</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:ex="http://example.com/" version="3.1"&gt; &lt;p:output port="result"/&gt; &lt;p:ixml parameters="map{'ex:select':'all'}"&gt; &lt;p:with-input port="grammar"&gt; &lt;p:inline content-type="text/plain"&gt; letters: X, (A; B; C) . A: digits . B: digits . C: digits . X: "a" . digits: ["0"-"9"]+ . &lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;p:with-input port="source"&gt; &lt;p:inline content-type="text/plain"&gt;a123&lt;/p:inline&gt; &lt;/p:with-input&gt; &lt;/p:ixml&gt; &lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">This might return three documents:</span></p><pre class="programlisting language-markup xml"><code><span class="deltaxml-new" style="background:#90EE90">&lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;C&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/C&gt;&lt;/letters&gt; &lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;B&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/B&gt;&lt;/letters&gt; &lt;letters ixml:state="ambiguous"&gt;&lt;X&gt;a&lt;/X&gt;&lt;A&gt;&lt;digits&gt;123&lt;/digits&gt;&lt;/A&gt;&lt;/letters&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">As before, there is nothing standardized about the results in this case.</span></p></div></section></div></section><section id="c.ixml.9" class="simplesect"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">Document properties</span></h4></div><div class="content"><p><span class="deltaxml-new" style="background:#90EE90">No document properties are preserved.</span></p></div></section></div></section></div></section><section id="errors" class="section"><div class="section-titlepage"><h2><bdi class="secno">3. </bdi>Step Errors<a aria-label="§" class="self-link" href="#errors"></a></h2></div><div class="content"><p>This step can raise <em class="glossterm"><a href="#dt-dynamic-error">dynamic errors</a></em>. </p><p><span id="dt-dynamic-error" class="termdef">[Definition: A <em class="glossterm">dynamic error</em> is one which occurs while a pipeline is being evaluated.]</span> Examples of dynamic errors include references to URIs that cannot be resolved, steps which fail, and pipelines that exhaust the capacity of an implementation (such as memory or disk space). For a more complete discussion of dynamic errors, see <cite><a href="../xproc/#dynamic-errors">Dynamic Errors</a></cite> in <cite><a href="../xproc/">XProc 3.0: An XML Pipeline Language</a></cite>. </p><p>If a step fails due to a dynamic error, failure propagates upwards until either a <code class="tag-element">p:try</code> is encountered or the entire pipeline fails. In other words, outside of a <code class="tag-element">p:try</code>, step failure causes the entire pipeline to fail.</p><p>The following errors can be raised by this step:</p><div id="step-error-summary"><dl class="errs"><dt id="err.C0205"><code class="errqname">err:XC0205</code></dt><dd><p>It is a dynamic error if the source document cannot be parsed by the provided grammar.</p><p>See: <a href="#err.inline.C0205">p:ixml</a></p></dd><dt id="err.C0211"><code class="errqname">err:XC0211</code></dt><dd><p>It is a dynamic error if more than one document appears on the grammar port.</p><p>See: <a href="#err.inline.C0211">p:ixml</a></p></dd><dt id="err.C0212"><code class="errqname">err:XC0212</code></dt><dd><p>It is a dynamic error if the grammar provided is not a valid Invisible XML grammar.</p><p>See: <a href="#err.inline.C0212">p:ixml</a></p></dd></dl></div></div></section><article class="appendix" id="conformance"><header class="appendix-titlepage"><h2><bdi class="secno">A. </bdi>Conformance<a aria-label="§" class="self-link" href="#conformance"></a></h2></header><div class="content"><p>Conformant processors <span class="rfc2119" id="conformance.2.1">must</span> implement all of the features described in this specification except those that are explicitly identified as optional.</p><p>Some aspects of processor behavior are not completely specified; those features are either <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> or <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em>.</p><p><span id="dt-implementation-dependent" class="termdef">[Definition: An <em class="glossterm">implementation-dependent</em> feature is one where the implementation has discretion in how it is performed. Implementations are not required to document or explain how <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> features are performed.]</span></p><p><span id="dt-implementation-defined" class="termdef">[Definition: An <em class="glossterm">implementation-defined</em> feature is one where the implementation has discretion in how it is performed. Conformant implementations <span class="rfc2119" id="dt-implementation-defined.2">must</span> document how <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em> features are performed.]</span></p><section class="section" id="implementation-defined"><div class="section-titlepage"><h2><bdi class="secno">A.1. </bdi>Implementation-defined features<a aria-label="§" class="self-link" href="#implementation-defined"></a></h2></div><div class="content"><p>The following features are implementation-defined:</p><ol class="features"><li>It is implementation-defined if other result formats are possible. See <a href="#c.ixml" title="p:ixml">Section <span class="deltaxml-old" style="background:#FF5555">2</span><span class="deltaxml-new" style="background:#90EE90">2.1</span>, “p:ixml”</a>.</li><li>The parameters are implementation-defined. See <a href="#c.ixml" title="p:ixml">Section <span class="deltaxml-old" style="background:#FF5555">2</span><span class="deltaxml-new" style="background:#90EE90">2.1</span>, “p:ixml”</a>.</li></ol></div></section><section id="implementation-dependent" class="section"><div class="section-titlepage"><h2><bdi class="secno">A.2. </bdi>Implementation-dependent features<a aria-label="§" class="self-link" href="#implementation-dependent"></a></h2></div><div class="content"><p>This step has no implementation-dependent features.</p><ol class="features"></ol></div></section></div></article><article class="appendix" id="references"><header class="appendix-titlepage"><h2><bdi class="secno">B. </bdi>References<a aria-label="§" class="self-link" href="#references"></a></h2></header><div class="content"><div class="bibliolist" id="references.2"><div id="xproc30" class="bibliomixed"><p><span class="deltaxml-old" style="background:#FF5555">[</span><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XProc 3.0</span></span><span class="deltaxml-old" style="background:#FF5555">] </span><a href="https://spec.xproc.org/3.0/xproc/"><span class="citetitle"><cite><span class="deltaxml-old" style="background:#FF5555">XProc 3.0: An XML Pipeline Language</span></cite></span></a><span class="deltaxml-old" style="background:#FF5555">. Norman Walsh, Achim Berndzen, Gerrit Imsieke and Erik Siegel, editors. </span></p></div><div id="xproc30-steps" class="bibliomixed"><p><span class="deltaxml-old" style="background:#FF5555">[</span><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XProc 3.0 Steps</span></span><span class="deltaxml-old" style="background:#FF5555">] </span><a href="https://spec.xproc.org/"><span class="citetitle"><cite><span class="deltaxml-old" style="background:#FF5555">XProc 3.0 Steps: An Introduction</span></cite></span></a><span class="deltaxml-old" style="background:#FF5555">. Norman Walsh, Achim Berndzen, Gerrit Imsieke and Erik Siegel, editors. </span></p></div><div id="xproc31" class="bibliomixed"><p><span class="deltaxml-new" style="background:#90EE90">[</span><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XProc 3.1</span></span><span class="deltaxml-new" style="background:#90EE90">] </span><a href="https://spec.xproc.org/lastcall-2024-08/head/xproc/"><span class="citetitle"><cite><span class="deltaxml-new" style="background:#90EE90">XProc 3.1: An XML Pipeline Language</span></cite></span></a><span class="deltaxml-new" style="background:#90EE90">. Norman Walsh, Achim Berndzen, Gerrit Imsieke and Erik Siegel, editors. </span></p></div><div id="invisible-xml" class="bibliomixed"><p>[<span class="abbrev">Invisible XML</span>] <a href="https://invisiblexml.org/1.0/"><span class="citetitle"><cite>Invisible XML Specification</cite></span></a>, version 1.0. Steven Pemberton, editor. Version 2022-06-20. </p></div></div></div></article><article id="glossary" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">C. </bdi>Glossary<a aria-label="§" class="self-link" href="#glossary"></a></h2></header><div class="content"><div class="glosslist"><dl><dt id="glossary.2.1" class="glossentry"><em class="glossterm"><a href="#dt-dynamic-error">dynamic error</a></em></dt><dd class="glossdef"><p>A <em class="firstterm">dynamic error</em> is one which occurs while a pipeline is being evaluated.</p></dd><dt id="glossary.2.2" class="glossentry"><em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em></dt><dd class="glossdef"><p>An <em class="firstterm">implementation-defined</em> feature is one where the implementation has discretion in how it is performed. Conformant implementations <span class="rfc2119" id="glossary.2.2.2.1.2">must</span> document how <em class="glossterm"><a href="#dt-implementation-defined">implementation-defined</a></em> features are performed.</p></dd><dt id="glossary.2.3" class="glossentry"><em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em></dt><dd class="glossdef"><p>An <em class="firstterm">implementation-dependent</em> feature is one where the implementation has discretion in how it is performed. Implementations are not required to document or explain how <em class="glossterm"><a href="#dt-implementation-dependent">implementation-dependent</a></em> features are performed.</p></dd></dl></div></div></article><article id="ancillary-files" class="appendix"><header class="appendix-titlepage"><h2><bdi class="secno">D. </bdi>Ancillary files<a aria-label="§" class="self-link" href="#ancillary-files"></a></h2></header><div class="content"><p>This specification includes by reference a number of ancillary files.</p><div class="variablelist"><dl><dt><span class="term"><a href="steps.xpl">steps.xpl</a></span></dt><dd><p>An XProc step library for the declared steps. </p></dd></dl></div></div></article></article><script src="js/prism.js"></script><script src="js/fixup.js"></script><script src="/js/scroll.js"></script></body></html>